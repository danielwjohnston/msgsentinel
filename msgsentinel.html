<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MsgSentinel - Protect Yourself from Harmful Messages</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="daniel-aesthetic.css">
    <style>
        /* Custom styles specific to the application */
        body {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: var(--bg);
            color: var(--text);
        }
        
        .container {
            flex: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        /* Card styles */
        .card {
            margin-bottom: 2rem;
        }
        
        .card-header {
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--line);
        }
        
        .card-header h1 {
            margin: 0;
            color: var(--accent);
            font-size: 2rem;
        }
        
        .card-header .subtitle {
            color: var(--muted);
            margin-top: 0.5rem;
        }
        
        .card-body {
            padding: 2rem;
        }
        
        .card-footer {
            padding: 1.5rem 2rem;
            border-top: 1px solid var(--line);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--line);
            padding: 0 2rem;
        }
        
        .tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            color: var(--muted);
            font-weight: 500;
            position: relative;
            transition: color 0.2s var(--ease);
        }
        
        .tab:after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            right: 0;
            height: 2px;
            background: transparent;
            transition: background-color 0.2s var(--ease);
        }
        
        .tab:hover {
            color: var(--text);
        }
        
        .tab.active {
            color: var(--accent);
        }
        
        .tab.active:after {
            background: var(--accent);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Form elements */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        textarea, input[type="text"] {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid var(--line);
            border-radius: var(--radius);
            background: var(--surface-2);
            color: var(--text);
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.2s var(--ease), box-shadow 0.2s var(--ease);
        }
        
        textarea:focus, input[type="text"]:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 2px rgba(0, 255, 0, 0.2);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: var(--radius);
            font-family: inherit;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s var(--ease);
        }
        
        .btn i {
            margin-right: 0.5rem;
        }
        
        .btn-primary {
            background: var(--accent);
            color: var(--bg);
        }
        
        .btn-primary:hover {
            background: var(--accent-700);
            transform: translateY(-1px);
        }
        
        .btn-outline {
            background: transparent;
            color: var(--accent);
            border: 1px solid var(--accent);
        }
        
        .btn-outline:hover {
            background: rgba(0, 255, 0, 0.1);
        }
        
        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        /* Stats */
        .stats {
            display: flex;
            gap: 2rem;
            margin-top: 1.5rem;
            color: var(--muted);
            font-size: 0.9rem;
        }
        
        .stat {
            display: flex;
            align-items: center;
        }
        
        .stat i {
            margin-right: 0.5rem;
            color: var(--accent);
        }
        
        /* History items */
        .history-item {
            padding: 1rem;
            border: 1px solid var(--line);
            border-radius: var(--radius);
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.2s var(--ease);
        }
        
        .history-item:hover {
            border-color: var(--accent);
        }
        
        .history-item p {
            margin: 0 0 0.5rem;
        }
        
        .history-time {
            font-size: 0.8rem;
            color: var(--muted);
        }
        
        /* Settings */
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid var(--line);
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .setting-label {
            font-weight: 500;
        }
        
        .setting-description {
            font-size: 0.85rem;
            color: var(--muted);
            margin-top: 0.25rem;
        }
        
        /* Switch */
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--surface-3);
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--accent);
        }
        
        input:focus + .slider {
            box-shadow: 0 0 1px var(--accent);
        }
        
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }
            
            .tabs {
                overflow-x: auto;
                padding: 0 1rem;
            }
            
            .tab {
                padding: 1rem;
                white-space: nowrap;
            }
            
            .card-body {
                padding: 1.5rem 1rem;
            }
            
            .card-footer {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .stats {
                flex-direction: column;
                gap: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1>MsgSentinel</h1>
                <div class="subtitle">Your shield against harmful messages</div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="sanitize">
                    <i class="fas fa-magic"></i> Sanitize
                </div>
                <div class="tab" data-tab="history">
                    <i class="fas fa-history"></i> History
                </div>
                <div class="tab" data-tab="settings">
                    <i class="fas fa-cog"></i> Settings
                </div>
            </div>
            
            <div class="card-body">
                <!-- Sanitize Tab -->
                <div class="tab-content active" id="sanitize-tab">
                    <div class="form-group">
                        <label for="inputMessage">Paste the message you received:</label>
                        <textarea id="inputMessage" placeholder="Paste the message you want to sanitize here..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Sanitized Message:</label>
                        <div id="result" class="card" style="min-height: 100px; padding: 1rem;">
                            <p class="text-muted">Your sanitized message will appear here...</p>
                        </div>
                    </div>
                    
                    <div class="stats">
                        <div class="stat">
                            <i class="fas fa-filter"></i>
                            <span id="filteredCount">0 words filtered</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-shield-alt"></i>
                            <span id="safetyLevel">Safety: <span class="text-success">Safe</span></span>
                        </div>
                    </div>
                </div>
                
                <!-- History Tab -->
                <div class="tab-content" id="history-tab">
                    <div id="historyList">
                        <p class="text-muted">Your sanitization history will appear here.</p>
                    </div>
                </div>
                
                <!-- Settings Tab -->
                <div class="tab-content" id="settings-tab">
                    <div class="form-group">
                        <h3>Filter Settings</h3>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Enable Profanity Filter</div>
                                <div class="setting-description">Block offensive language and slurs</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="profanityFilter" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Filter Threats</div>
                                <div class="setting-description">Block threatening or harmful content</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="threatFilter" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Filter Personal Attacks</div>
                                <div class="setting-description">Block personal insults and attacks</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="personalAttackFilter" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 2rem;">
                        <h3>History Settings</h3>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Save Message History</div>
                                <div class="setting-description">Store your sanitized messages locally</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="saveHistory" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div style="margin-top: 1.5rem;">
                            <button id="clearHistoryBtn" class="btn btn-outline">
                                <i class="fas fa-trash"></i> Clear History
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card-footer">
                <button class="btn btn-primary" id="sanitizeBtn">
                    <i class="fas fa-magic"></i> Sanitize Message
                </button>
                <div>
                    <button class="btn btn-outline" id="copyBtn">
                        <i class="far fa-copy"></i> Copy
                    </button>
                    <button class="btn btn-outline ml-2" id="clearBtn">
                        <i class="fas fa-eraser"></i> Clear
                    </button>
                </div>
            </div>
        </div>
        
        <footer class="text-center text-muted text-sm" style="margin-top: 2rem;">
            <p>MsgSentinel &copy; 2023 | All messages are processed locally in your browser</p>
        </footer>
    </div>

    <script>
        // Enhanced word lists for filtering
        const filterLists = {
            profanity: [
                // Profanity word list (truncated for brevity)
                '\b(ass|arse|asshole|arsehole|bitch|bastard|bollocks|bullshit|bitchy|bitching|blowjob|blow job|blow me|blowjob|blow jobs|blowjobs|blow job|blowjob|blow jobs|blowjobs|blow job|blowjob|blow jobs|blowjobs|blow job|blowjob|blow jobs|blowjobs)\b',
                // Add more words as needed
            ],
            threats: [
                // Threatening language patterns
                '\b(kill|harm|hurt|attack|beat|fight|stab|shoot|bomb|murder|threat|threaten|threatening|violent|violence|rape|raping|raped|rapist|abuse|abusing|abused|abuser|harass|harassing|harassed|harassment|stalking|stalker|stalk|stalked|revenge|dox|doxx|doxxing|doxing|doxed|doxxed|swat|swatting|swatted|swatter)\b',
                // Add more patterns as needed
            ],
            personalAttacks: [
                // Personal attack patterns
                '\b(idiot|moron|stupid|dumb|retard|retarded|ugly|fat|useless|worthless|failure|loser|hate you|i hate you|i hope you die|i wish you were dead|kill yourself|go die|you should die|you\'re a waste|you\'re pathetic|you\'re worthless|you\'re useless|you\'re a loser|you\'re a failure|you\'re a mistake|you\'re garbage|you\'re trash|you\'re a waste of space|you\'re a waste of oxygen|you\'re a waste of time|you\'re a waste of life|you\'re a waste of skin|you\'re a waste of air|you\'re a waste of breath|you\'re a waste of space|you\'re a waste of time|you\'re a waste of life|you\'re a waste of skin|you\'re a waste of air|you\'re a waste of breath)\b',
                // Add more patterns as needed
            ]
        };
        
        // DOM Elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const inputMessage = document.getElementById('inputMessage');
        const resultElement = document.getElementById('result');
        const sanitizeBtn = document.getElementById('sanitizeBtn');
        const copyBtn = document.getElementById('copyBtn');
        const clearBtn = document.getElementById('clearBtn');
        const clearHistoryBtn = document.getElementById('clearHistoryBtn');
        const historyList = document.getElementById('historyList');
        const filteredCountElement = document.getElementById('filteredCount');
        const safetyLevelElement = document.getElementById('safetyLevel');
        const profanityFilter = document.getElementById('profanityFilter');
        const threatFilter = document.getElementById('threatFilter');
        const personalAttackFilter = document.getElementById('personalAttackFilter');
        const saveHistory = document.getElementById('saveHistory');
        
        // Initialize the app
        function init() {
            // Load settings
            loadSettings();
            
            // Load history
            renderHistory();
            
            // Set up event listeners
            tabs.forEach(tab => {
                tab.addEventListener('click', switchTab);
            });
            
            sanitizeBtn.addEventListener('click', sanitizeMessage);
            copyBtn.addEventListener('click', copyToClipboard);
            clearBtn.addEventListener('click', clearMessage);
            clearHistoryBtn.addEventListener('click', clearHistory);
            
            // Settings change listeners
            profanityFilter.addEventListener('change', saveSettings);
            threatFilter.addEventListener('change', saveSettings);
            personalAttackFilter.addEventListener('change', saveSettings);
            saveHistory.addEventListener('change', saveSettings);
            
            // Set initial tab
            switchTab({ target: document.querySelector('.tab[data-tab="sanitize"]') });
        }
        
        // Switch between tabs
        function switchTab(e) {
            const tab = e.target.closest('.tab');
            if (!tab) return;
            
            // Update active tab
            tabs.forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            
            // Show corresponding content
            const tabId = tab.getAttribute('data-tab');
            tabContents.forEach(content => {
                content.classList.toggle('active', content.id === `${tabId}-tab`);
            });
        }
        
        // Sanitize the message
        function sanitizeMessage() {
            const input = inputMessage.value.trim();
            
            if (!input) {
                showEmptyState('Please enter a message to sanitize.');
                return;
            }
            
            let sanitized = input;
            let filteredWords = 0;
            
            // Apply filters based on settings
            if (profanityFilter.checked) {
                const result = applyFilter(sanitized, filterLists.profanity);
                sanitized = result.text;
                filteredWords += result.count;
            }
            
            if (threatFilter.checked) {
                const result = applyFilter(sanitized, filterLists.threats);
                sanitized = result.text;
                filteredWords += result.count;
            }
            
            if (personalAttackFilter.checked) {
                const result = applyFilter(sanitized, filterLists.personalAttacks);
                sanitized = result.text;
                filteredWords += result.count;
            }
            
            // Update UI
            filteredCountElement.textContent = `${filteredWords} words filtered`;
            updateSafetyLevel(filteredWords, input.length);
            
            // Format the output
            if (sanitized.trim() === '') {
                showEmptyState('This message was filtered out as it contained harmful content.');
            } else {
                // Preserve line breaks and formatting
                const formattedMessage = sanitized
                    .replace(/\n\s*\n/g, '</p><p>')  // Double newlines become paragraph breaks
                    .replace(/\n/g, '<br>');       // Single newlines become line breaks
                
                resultElement.innerHTML = `<p>${formattedMessage}</p>`;
            }
            
            // Save to history if enabled
            if (saveHistory.checked && filteredWords > 0) {
                saveToHistory(input, sanitized, filteredWords);
            }
        }
        
        // Apply a filter to the text
        function applyFilter(text, wordList) {
            let filteredText = text;
            let count = 0;
            
            wordList.forEach(word => {
                const regex = new RegExp(word, 'gi');
                const matches = filteredText.match(regex) || [];
                count += matches.length;
                filteredText = filteredText.replace(regex, match => {
                    return '<span class="filtered-word" style="background: rgba(255, 0, 0, 0.2); color: var(--danger); padding: 0 2px; border-radius: 3px; text-decoration: line-through;" title="Filtered word">' + 
                           '<span style="opacity: 0.5;">' + match + '</span>' + 
                           '</span>';
                });
            });
            
            return { text: filteredText, count };
        }
        
        // Update safety level indicator
        function updateSafetyLevel(filteredCount, inputLength) {
            const ratio = filteredCount / (inputLength / 5); // Rough estimate of word count
            
            if (filteredCount === 0) {
                safetyLevelElement.innerHTML = 'Safety: <span class="text-success">Safe</span>';
            } else if (ratio < 0.1) {
                safetyLevelElement.innerHTML = 'Safety: <span class="text-success">Mostly Safe</span>';
            } else if (ratio < 0.3) {
                safetyLevelElement.innerHTML = 'Safety: <span class="text-warning">Caution</span>';
            } else {
                safetyLevelElement.innerHTML = 'Safety: <span class="text-danger">Warning</span>';
            }
        }
        
        // Show empty state
        function showEmptyState(message) {
            resultElement.innerHTML = `<p class="text-muted">${message}</p>`;
        }
        
        // Clear the input and output
        function clearMessage() {
            inputMessage.value = '';
            showEmptyState('Your sanitized message will appear here...');
            filteredCountElement.textContent = '0 words filtered';
            safetyLevelElement.innerHTML = 'Safety: <span class="text-success">Safe</span>';
        }
        
        // Copy sanitized message to clipboard
        function copyToClipboard() {
            const resultText = resultElement.textContent.trim();
            
            if (!resultText || resultText.includes('Your sanitized message will appear here')) {
                alert('No sanitized message to copy!');
                return;
            }
            
            navigator.clipboard.writeText(resultText).then(() => {
                // Show a temporary success message
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy text. Please try again.');
            });
        }
        
        // Save message to history
        function saveToHistory(original, sanitized, filteredCount) {
            const history = JSON.parse(localStorage.getItem('messageHistory') || '[]');
            const now = new Date();
            
            const historyItem = {
                id: Date.now(),
                original,
                sanitized,
                filteredCount,
                date: now.toLocaleDateString(),
                time: now.toLocaleTimeString(),
                timestamp: now.getTime()
            };
            
            // Add to beginning of array (most recent first)
            history.unshift(historyItem);
            
            // Keep only the last 50 items
            if (history.length > 50) {
                history.pop();
            }
            
            localStorage.setItem('messageHistory', JSON.stringify(history));
            renderHistory();
        }
        
        // Render message history
        function renderHistory() {
            const history = JSON.parse(localStorage.getItem('messageHistory') || '[]');
            
            if (history.length === 0) {
                historyList.innerHTML = '<p class="text-muted">Your sanitization history will appear here.</p>';
                return;
            }
            
            const historyItems = history.map(item => `
                <div class="history-item" data-id="${item.id}">
                    <p>${item.sanitized.substring(0, 100)}${item.sanitized.length > 100 ? '...' : ''}</p>
                    <div class="history-time">
                        ${item.date} at ${item.time} • ${item.filteredCount} filtered item${item.filteredCount !== 1 ? 's' : ''}
                    </div>
                </div>
            `).join('');
            
            historyList.innerHTML = historyItems;
            
            // Add click handlers to history items
            document.querySelectorAll('.history-item').forEach(item => {
                item.addEventListener('click', () => {
                    const id = parseInt(item.getAttribute('data-id'));
                    const historyItem = history.find(h => h.id === id);
                    if (historyItem) {
                        // Switch to sanitize tab
                        document.querySelector('.tab[data-tab="sanitize"]').click();
                        
                        // Fill in the input and show the result
                        inputMessage.value = historyItem.original;
                        resultElement.innerHTML = `<p>${historyItem.sanitized}</p>`;
                        filteredCountElement.textContent = `${historyItem.filteredCount} words filtered`;
                        updateSafetyLevel(historyItem.filteredCount, historyItem.original.length);
                        
                        // Scroll to top
                        window.scrollTo(0, 0);
                    }
                });
            });
        }
        
        // Clear history
        function clearHistory() {
            if (confirm('Are you sure you want to clear your history? This cannot be undone.')) {
                localStorage.removeItem('messageHistory');
                renderHistory();
            }
        }
        
        // Save settings to localStorage
        function saveSettings() {
            const settings = {
                profanityFilter: profanityFilter.checked,
                threatFilter: threatFilter.checked,
                personalAttackFilter: personalAttackFilter.checked,
                saveHistory: saveHistory.checked
            };
            
            localStorage.setItem('msgSentinelSettings', JSON.stringify(settings));
        }
        
        // Load settings from localStorage
        function loadSettings() {
            const settings = JSON.parse(localStorage.getItem('msgSentinelSettings') || '{}');
            
            // Apply saved settings or use defaults
            profanityFilter.checked = settings.profanityFilter !== undefined ? settings.profanityFilter : true;
            threatFilter.checked = settings.threatFilter !== undefined ? settings.threatFilter : true;
            personalAttackFilter.checked = settings.personalAttackFilter !== undefined ? settings.personalAttackFilter : true;
            saveHistory.checked = settings.saveHistory !== undefined ? settings.saveHistory : true;
        }
        
        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>