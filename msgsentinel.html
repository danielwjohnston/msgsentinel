<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MsgSentinel - Protect Yourself from Harmful Messages</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --secondary: #3730a3;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --light: #f9fafb;
            --dark: #111827;
            --gray: #6b7280;
            --light-gray: #e5e7eb;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f0f2f5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .card-header {
            background: var(--primary);
            color: white;
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .card-body {
            padding: 1.5rem;
        }
        
        .card-footer {
            background: var(--light);
            padding: 1rem 1.5rem;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.95rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--dark);
        }
        
        textarea {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            border: 2px solid var(--light-gray);
            border-radius: 8px;
            font-family: inherit;
            font-size: 1rem;
            line-height: 1.5;
            transition: all 0.2s ease;
            resize: vertical;
        }
        
        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.15);
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 0.625rem 1.25rem;
            font-size: 1rem;
            font-weight: 500;
            line-height: 1.5;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            background: var(--primary);
            color: white;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn i {
            margin-right: 0.5rem;
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--gray);
            color: var(--gray);
        }
        
        .btn-outline:hover {
            background: var(--light-gray);
            color: var(--dark);
        }
        
        .output-box {
            min-height: 150px;
            padding: 1.25rem;
            background: var(--light);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .stats {
            display: flex;
            gap: 1.5rem;
            margin-top: 1rem;
            color: var(--gray);
            font-size: 0.875rem;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .stat-value {
            font-weight: 600;
            color: var(--dark);
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--light-gray);
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 0.75rem 1.25rem;
            cursor: pointer;
            font-weight: 500;
            color: var(--gray);
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .settings-panel {
            background: var(--light);
            border-radius: 8px;
            padding: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .setting-label {
            font-weight: 500;
        }
        
        .setting-description {
            font-size: 0.85rem;
            color: var(--gray);
            margin-top: 0.25rem;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 44px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:focus + .slider {
            box-shadow: 0 0 1px var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--gray);
        }
        
        .empty-state i {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--light-gray);
        }
        
        .history-item {
            padding: 1rem;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .history-item:hover {
            background: var(--light);
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-preview {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            color: var(--gray);
            font-size: 0.9rem;
            margin-top: 0.25rem;
        }
        
        .history-time {
            font-size: 0.8rem;
            color: #adb5bd;
            margin-top: 0.25rem;
        }
        
        @media (max-width: 768px) {
            .card-body {
                padding: 1rem;
            }
            
            .stats {
                flex-direction: column;
                gap: 0.5rem;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h1>MsgSentinel</h1>
                <div class="subtitle">Your shield against harmful messages</div>
            </div>
            
            <div class="tabs">
                <div class="tab active" data-tab="sanitize">Sanitize</div>
                <div class="tab" data-tab="history">History</div>
                <div class="tab" data-tab="settings">Settings</div>
            </div>
            
            <div class="card-body">
                <!-- Sanitize Tab -->
                <div class="tab-content active" id="sanitize-tab">
                    <div class="form-group">
                        <label for="inputMessage">Paste the message you received:</label>
                        <textarea id="inputMessage" placeholder="Enter or paste the message you want to sanitize here..."></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label>Sanitized Message:</label>
                        <div class="output-box" id="result">
                            <div class="empty-state">
                                <i class="fas fa-comment-slash"></i>
                                <p>Your sanitized message will appear here</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="stats">
                        <div class="stat-item">
                            <i class="fas fa-filter"></i>
                            <span>Filtered: <span id="filteredCount">0</span> words</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-shield-alt"></i>
                            <span>Safety level: <span id="safetyLevel">High</span></span>
                        </div>
                    </div>
                </div>
                
                <!-- History Tab -->
                <div class="tab-content" id="history-tab">
                    <div id="historyList">
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <p>Your sanitized messages will appear here</p>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Tab -->
                <div class="tab-content" id="settings-tab">
                    <div class="settings-panel">
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Enable Profanity Filter</div>
                                <div class="setting-description">Block offensive language and slurs</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="profanityFilter" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Filter Threats</div>
                                <div class="setting-description">Block threatening or harmful content</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="threatFilter" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Filter Personal Attacks</div>
                                <div class="setting-description">Block personal insults and attacks</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="personalAttackFilter" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                        
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">Save Message History</div>
                                <div class="setting-description">Store your sanitized messages locally</div>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="saveHistory" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card-footer">
                <button class="btn" id="sanitizeBtn">
                    <i class="fas fa-magic"></i> Sanitize Message
                </button>
                <div>
                    <button class="btn btn-outline" id="clearBtn">
                        <i class="fas fa-eraser"></i> Clear
                    </button>
                    <button class="btn btn-outline" id="copyBtn">
                        <i class="far fa-copy"></i> Copy
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Enhanced word lists for filtering
        const filterLists = {
            profanity: [
                // Basic profanity
                'idiot', 'stupid', 'ugly', 'worthless', 'failure', 'useless', 'dumb', 
                'fat', 'disgusting', 'hate', 'pathetic', 'loser', 'bitch', 'slut', 'whore', 
                'cunt', 'dick', 'asshole', 'fuck', 'shit', 'damn', 'piss', 'bastard', 'douche',
                'retard', 'nigger', 'nigga', 'chink', 'spic', 'kike', 'gook', 'towelhead',
                'raghead', 'wetback', 'beaner', 'coon', 'wop', 'dago', 'kraut', 'mick',
                'paddy', 'gypsy', 'paki', 'sambo', 'savage', 'taco', 'wog', 'yid',
                'gook', 'gyp', 'heeb', 'hymie', 'jap'
            ],
            
            threats: [
                // Threats and self-harm
                'kill yourself', 'you should die', 'end your life', 'commit suicide',
                'i\'ll kill you', 'i will kill you', 'i\'ll hurt you', 'i will hurt you',
                'you deserve to die', 'you should be dead', 'i hope you die',
                'i wish you were dead', 'go die', 'drop dead', 'i\'ll beat you',
                'i will beat you', 'i\'ll hit you', 'i will hit you', 'i\'ll punch you',
                'i will punch you', 'i\'ll stab you', 'i will stab you', 'i\'ll shoot you',
                'i will shoot you', 'i\'ll kill myself', 'i will kill myself',
                'i\'m going to kill myself', 'i am going to kill myself', 'i want to die',
                'i want to kill myself', 'i want to end it all', 'i want to end my life'
            ],
            
            personalAttacks: [
                // Personal attacks and insults
                'you are a bad', 'you are an awful', 'you are terrible', 'you are horrible',
                'you are disgusting', 'you are worthless', 'you are useless', 'you are a failure',
                'you are a loser', 'you are an idiot', 'you are stupid', 'you are dumb',
                'you are ugly', 'you are fat', 'you are disgusting', 'you are hateful',
                'you are pathetic', 'you are a bitch', 'you are a slut', 'you are a whore',
                'you are a mistake', 'you ruin everything', 'you are a burden',
                'you are not good enough', 'you will never succeed', 'you are a disappointment',
                'nobody likes you', 'everyone hates you', 'you have no friends',
                'you are a waste of space', 'you are a waste of oxygen', 'you are a waste of time',
                'you are a waste of life', 'you are a waste of skin', 'you are a waste of air'
            ]
        };

        // DOM Elements
        const inputMessage = document.getElementById('inputMessage');
        const resultElement = document.getElementById('result');
        const sanitizeBtn = document.getElementById('sanitizeBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const filteredCount = document.getElementById('filteredCount');
        const safetyLevel = document.getElementById('safetyLevel');
        const historyList = document.getElementById('historyList');
        
        // Settings elements
        const profanityFilter = document.getElementById('profanityFilter');
        const threatFilter = document.getElementById('threatFilter');
        const personalAttackFilter = document.getElementById('personalAttackFilter');
        const saveHistory = document.getElementById('saveHistory');
        
        // Tab elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        // Message history
        let messageHistory = JSON.parse(localStorage.getItem('messageHistory')) || [];
        
        // Initialize the app
        function init() {
            // Load settings from localStorage
            loadSettings();
            
            // Load message history
            renderHistory();
            
            // Event listeners
            sanitizeBtn.addEventListener('click', sanitizeMessage);
            clearBtn.addEventListener('click', clearMessage);
            copyBtn.addEventListener('click', copyToClipboard);
            
            // Tab switching
            tabs.forEach(tab => {
                tab.addEventListener('click', switchTab);
            });
            
            // Settings changes
            profanityFilter.addEventListener('change', saveSettings);
            threatFilter.addEventListener('change', saveSettings);
            personalAttackFilter.addEventListener('change', saveSettings);
            saveHistory.addEventListener('change', saveSettings);
            
            // Allow Enter to submit (Shift+Enter for new line)
            inputMessage.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sanitizeMessage();
                }
            });
            
            // Check for URL parameters (for future SMS integration)
            const urlParams = new URLSearchParams(window.location.search);
            const message = urlParams.get('message');
            if (message) {
                inputMessage.value = decodeURIComponent(message);
                sanitizeMessage();
            }
        }
        
        // Switch between tabs
        function switchTab(e) {
            const tabId = e.target.getAttribute('data-tab');
            
            // Update active tab
            tabs.forEach(tab => tab.classList.remove('active'));
            e.target.classList.add('active');
            
            // Show corresponding content
            tabContents.forEach(content => {
                content.classList.remove('active');
                if (content.id === `${tabId}-tab`) {
                    content.classList.add('active');
                }
            });
        }
        
        // Sanitize the message
        function sanitizeMessage() {
            const input = inputMessage.value.trim();
            
            if (!input) {
                showEmptyState('Please enter a message to sanitize.');
                return;
            }
            
            let sanitized = input;
            let filteredWords = 0;
            
            // Apply filters based on settings
            if (profanityFilter.checked) {
                const result = applyFilter(sanitized, filterLists.profanity);
                sanitized = result.text;
                filteredWords += result.count;
            }
            
            if (threatFilter.checked) {
                const result = applyFilter(sanitized, filterLists.threats);
                sanitized = result.text;
                filteredWords += result.count;
            }
            
            if (personalAttackFilter.checked) {
                const result = applyFilter(sanitized, filterLists.personalAttacks);
                sanitized = result.text;
                filteredWords += result.count;
            }
            
            // Update UI
            filteredCount.textContent = filteredWords;
            updateSafetyLevel(filteredWords, input.length);
            
            // Format the output
            if (sanitized.trim() === '') {
                showEmptyState('This message was filtered out as it contained harmful content.');
            } else {
                // Preserve line breaks and formatting
                const formattedMessage = sanitized
                    .replace(/\n\s*\n/g, '</p><p>')  // Double newlines become paragraph breaks
                    .replace(/\n/g, '<br>');       // Single newlines become line breaks
                
                resultElement.innerHTML = `<p>${formattedMessage}</p>`;
            }
            
            // Save to history if enabled
            if (saveHistory.checked && filteredWords > 0) {
                saveToHistory(input, sanitized, filteredWords);
            }
        }
        
        // Apply a filter to the text
        function applyFilter(text, wordList) {
            let count = 0;
            let result = text;
            
            wordList.forEach(word => {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                const matches = result.match(regex);
                if (matches) {
                    count += matches.length;
                    result = result.replace(regex, '[content removed]');
                }
            });
            
            return { text: result, count };
        }
        
        // Update safety level indicator
        function updateSafetyLevel(filteredCount, inputLength) {
            const ratio = filteredCount / (inputLength / 5); // Rough estimate of word count
            
            if (filteredCount === 0) {
                safetyLevel.textContent = 'Safe';
                safetyLevel.style.color = '#28a745';
            } else if (ratio < 0.1) {
                safetyLevel.textContent = 'Mostly Safe';
                safetyLevel.style.color = '#4cc9f0';
            } else if (ratio < 0.3) {
                safetyLevel.textContent = 'Caution';
                safetyLevel.style.color = '#ffc107';
            } else {
                safetyLevel.textContent = 'Warning';
                safetyLevel.style.color = '#f72585';
            }
        }
        
        // Show empty state
        function showEmptyState(message) {
            resultElement.innerHTML = `
                <div class="empty-state">
                    <i class="fas fa-comment-slash"></i>
                    <p>${message}</p>
                </div>
            `;
        }
        
        // Clear the input and output
        function clearMessage() {
            inputMessage.value = '';
            showEmptyState('Your sanitized message will appear here');
            filteredCount.textContent = '0';
            safetyLevel.textContent = 'High';
            safetyLevel.style.color = '#28a745';
        }
        
        // Copy sanitized message to clipboard
        function copyToClipboard() {
            const resultText = resultElement.textContent.trim();
            
            if (!resultText || resultText.includes('Your sanitized message will appear here')) {
                alert('No sanitized message to copy!');
                return;
            }
            
            navigator.clipboard.writeText(resultText)
                .then(() => {
                    const originalText = copyBtn.innerHTML;
                    copyBtn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                    setTimeout(() => {
                        copyBtn.innerHTML = originalText;
                    }, 2000);
                })
                .catch(err => {
                    console.error('Failed to copy text: ', err);
                    alert('Failed to copy text to clipboard');
                });
        }
        
        // Save message to history
        function saveToHistory(original, sanitized, filteredCount) {
            const now = new Date();
            const message = {
                id: Date.now(),
                original: original,
                sanitized: sanitized,
                filteredCount: filteredCount,
                timestamp: now.toISOString(),
                date: now.toLocaleDateString(),
                time: now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })
            };
            
            // Add to beginning of array (most recent first)
            messageHistory.unshift(message);
            
            // Keep only the last 50 messages
            if (messageHistory.length > 50) {
                messageHistory = messageHistory.slice(0, 50);
            }
            
            // Save to localStorage
            localStorage.setItem('messageHistory', JSON.stringify(messageHistory));
            
            // Update the history display
            renderHistory();
        }
        
        // Render message history
        function renderHistory() {
            if (messageHistory.length === 0) {
                historyList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <p>Your sanitized messages will appear here</p>
                    </div>
                `;
                return;
            }
            
            const historyItems = messageHistory.map(msg => `
                <div class="history-item" data-id="${msg.id}">
                    <div class="history-preview">${msg.sanitized.substring(0, 100)}${msg.sanitized.length > 100 ? '...' : ''}</div>
                    <div class="history-time">${msg.date} at ${msg.time} • ${msg.filteredCount} filtered items</div>
                </div>
            `).join('');
            
            historyList.innerHTML = historyItems;
            
            // Add click handlers to history items
            document.querySelectorAll('.history-item').forEach(item => {
                item.addEventListener('click', () => {
                    const messageId = parseInt(item.getAttribute('data-id'));
                    const message = messageHistory.find(msg => msg.id === messageId);
                    if (message) {
                        // Switch to sanitize tab
                        document.querySelector('[data-tab="sanitize"]').click();
                        
                        // Populate the input and sanitize
                        inputMessage.value = message.original;
                        sanitizeMessage();
                        
                        // Scroll to top
                        window.scrollTo(0, 0);
                    }
                });
            });
        }
        
        // Save settings to localStorage
        function saveSettings() {
            const settings = {
                profanityFilter: profanityFilter.checked,
                threatFilter: threatFilter.checked,
                personalAttackFilter: personalAttackFilter.checked,
                saveHistory: saveHistory.checked
            };
            
            localStorage.setItem('messageSanitizerSettings', JSON.stringify(settings));
        }
        
        // Load settings from localStorage
        function loadSettings() {
            const savedSettings = localStorage.getItem('messageSanitizerSettings');
            
            if (savedSettings) {
                const settings = JSON.parse(savedSettings);
                
                profanityFilter.checked = settings.profanityFilter !== false; // Default to true
                threatFilter.checked = settings.threatFilter !== false; // Default to true
                personalAttackFilter.checked = settings.personalAttackFilter !== false; // Default to true
                saveHistory.checked = settings.saveHistory !== false; // Default to true
            }
        }
        
        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>